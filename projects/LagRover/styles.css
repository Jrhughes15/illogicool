/* LagRover UI Styles (v3.8) — three-column layout + modal help + legend
   Palette stays in the deep-blue theme with soft shadows and rounded cards.
*/

/* ---------- Theme ---------- */
:root{
  --bg: #0b1426;
  --bg-soft: #0e1a30;
  --panel: #0f1f3a;
  --panel-2: #0c1a31;
  --ink: #d9e6ff;
  --ink-dim: #93a7cc;
  --ink-muted: #6b86b8;
  --accent: #8fd3ff;
  --accent-2: #63ff9c;
  --warn: #ffd36a;
  --bad: #ff8b8b;
  --ok:  #79ffb0;
  --grid: #152640;
  --grid-line: #0c152b;
  --chip: #102544;
  --chip-ink:#cfe7ff;
  --shadow: 0 8px 24px rgba(0,0,0,.35);
  --radius: 14px;

  /* cap the rendered grid height to fit the viewport (you set 75vh, keep/tune here) */
  --grid-viewport: 75vh; /* try 62–80vh depending on your screen */
}

/* ---------- Base ---------- */
*{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0;
  background: radial-gradient(1200px 800px at 50% -10%, #0c1b33 0%, #08101f 60%, #070d19 100%);
  color:var(--ink);
  font: 14px/1.55 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
  letter-spacing:.2px;
}
h1{ margin:0; font-weight:800; letter-spacing:.5px; }
h2,h3{ margin:.25rem 0 .75rem; font-weight:700; }

/* Generic button style used across the app */
.btn {
  background: #1a2a44;
  border: 1px solid var(--chipline);
  color: var(--text);
  padding: 6px 10px;
  border-radius: 8px;
  cursor: pointer;
}
.btn:hover { filter: brightness(1.1); }
.btn:active { transform: translateY(1px); }


/* ---------- Header / Seed Bar ---------- */
.header{
  display:flex; align-items:center; gap:16px;
  padding:14px 16px 6px 16px;
}
.brand{ display:flex; align-items:baseline; gap:10px; }
.brand .ver{ font-size:12px; color:var(--ink-muted); }

.seedbar{
  display:flex; align-items:center; gap:10px; flex-wrap:wrap;
  padding:0 16px 10px 16px;
}
.seedbar .seed{ color:var(--ink-dim); }
.seedbar .btn, .seedbar select{
  height:28px; border-radius:10px; background:#102544; color:var(--ink);
  border:1px solid #193256; padding:0 10px; cursor:pointer;
}
.seedbar .btn:hover{ filter:brightness(1.1); }
.seedbar .btn:active{ transform:translateY(1px); }

/* ---------- 3-Column Layout ---------- */
.layout.layout-3col{
  display:grid;
  grid-template-columns: 405px 1fr 405px;
  gap:16px;
  padding:0 16px 16px 16px;
}
.col-left, .col-mid, .col-right{ min-width:0; }

/* ---------- Panels / Cards ---------- */
.panel{
  background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
  border:1px solid #0e2344;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:14px;
}

/* Let the canvas panel show its own starfield backdrop */
.panel.canvaswrap { background: none; }

.panel h3{
  margin:2px 0 10px; font-size:15px; color:#d1e3ff; letter-spacing:.3px;
}

.subtle{ color:var(--ink-muted); font-size:12px; }

/* ---------- Objectives ---------- */
.objectives .story{ color:var(--ink-dim); margin-bottom:10px; }
.objectives ul{ list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px; }
.objectives li{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 12px; background:#0e1f38; border:1px solid #122a4f; border-radius:10px;
}
.objectives li.done{ opacity:.6; }
.badge{
  font-size:11px; padding:3px 8px; border-radius:999px; border:1px solid #1e406f;
  background:#0c1e39; color:#cfe2ff;
}
.badge.ok{ border-color:#2e6a4a; color:#bdfad8; background:#0f2b22; }
.badge.warn{ border-color:#6a5a2e; color:#ffe39c; background:#221d0f; }

/* ---------- Inventory ---------- */
.inventory .help { color:var(--ink-dim); font-size:12px; margin-top:6px; }
#inventory{ list-style:none; margin:10px 0 0; padding:0; display:flex; flex-direction:column; gap:6px; }
#inventory li{
  display:flex; align-items:center; gap:8px;
  background:#0e1f38; border:1px solid #122a4f; border-radius:10px; padding:8px 10px;
}
.invIndex{
  width:22px; height:22px; line-height:22px; text-align:center;
  border-radius:6px; background:#122a4f; color:#cfe2ff; font-weight:700; font-size:12px;
}
.invLabel{ color:#cfe2ff; }

/* Inventory scrolling when long */
#inventoryList, #inventoryPanel .panel-body, #inventoryPanel {
  max-height: 220px;   /* adjust to taste */
  overflow-y: auto;
}

/* ---------- Crew Messages ---------- */
.messages .msg{
  background:#0e1f38; border:1px solid #122a4f; border-radius:10px; padding:10px 12px; margin-top:8px;
}
.messages .msg .who{ color:#b0c7f0; font-weight:700; }
.messages .msg .btns{ display:flex; gap:8px; margin-top:8px; }
.messages .msg button{ background:#102544; border:1px solid #193256; color:var(--ink); border-radius:8px; padding:6px 10px; cursor:pointer; }
.messages .msg button:hover{ filter:brightness(1.1); }

/* ---------- Middle Column: Canvas + Telemetry ---------- */
/* Make the middle panel fill its entire column,
   keep the canvas centered, and let the HUD span full width. */
.canvaswrap{
  position: relative;
  overflow: hidden;               /* keep bg inside rounded corners */
  border: 1px solid #0d223f;
  border-radius: var(--radius);
  padding: 10px;
  box-shadow: var(--shadow);
  width: 100%;
  background: transparent;        /* bg moved to ::before so it fills all space */
}

/* Starry background that fills the WHOLE middle panel */
.canvaswrap::before{
  content: "";
  position: absolute;
  inset: 0;                       /* fill entire panel */
  border-radius: inherit;
  z-index: 0;
  pointer-events: none;
  background:
    radial-gradient(900px 540px at 50% 0%, #0b1830 0%, #0a1325 40%, #081223 100%),
    radial-gradient(#162a44 1px, transparent 1px) 0 0/4px 4px,
    radial-gradient(#11233d 1px, transparent 1px) 2px 2px/4px 4px;
}

/* Ensure canvas & HUD render above the panel backdrop */
.canvaswrap #game,
.canvaswrap .hud{
  position: relative;
  z-index: 1;
}

/* Center the canvas and keep it at a fixed max size derived from viewport height.
   NOTE: we moved the width/size cap from .canvaswrap to the canvas element itself. */
#game{
  display:block;
  margin: 0 auto;          /* center in the wide middle column */
  height:auto;
  image-rendering: pixelated;
  background: transparent; /* starfield is painted by .canvaswrap::before */
  border-radius:10px;

  /* keep render height <= viewport cap, and width consistent with canvas aspect (800x660 ≈ 1.2121) */
  max-height: var(--grid-viewport);
  width: auto;
  max-width: min(100%, calc(1.2121 * var(--grid-viewport)));
}

/* HUD spans the entire middle column now */
.hud{
  width:100%;
  margin-top:10px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  background:#0d1d36; border:1px solid #11294d; color:#cfe2ff;
  padding:8px 10px; border-radius:10px;
  white-space:nowrap; overflow:auto;
}
#hoverInfo{ margin-left:10px; color:#9ec7ff; }

/* ---------- Right Column: Mission Console ---------- */
.console .codeArea{
  width:100%; min-height:160px; resize:vertical;
  border-radius:10px; border:1px solid #153158; background:#0c1c34; color:var(--ink);
  padding:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
}
.controls{ display:flex; flex-wrap:wrap; align-items:center; gap:8px; margin-top:8px; }
.controls .btn{
  background:#102544; color:var(--ink); border:1px solid #193256; border-radius:10px; padding:6px 10px; cursor:pointer;
}
.controls .btn:hover{ filter:brightness(1.1); }
.range{
  appearance:none; width:150px; height:6px; border-radius:999px; background:#17345e; outline:none;
}
.range::-webkit-slider-thumb{ appearance:none; width:16px; height:16px; border-radius:50%; background:#7ec8ff; border:2px solid #16365f; cursor:pointer; }

/* ---------- Queue & Log ---------- */
.queue{ display:flex; flex-wrap:wrap; gap:8px; min-height:38px; }
.chip{
  background:var(--chip); color:var(--chip-ink);
  border:1px solid #1a3a64; border-radius:999px; padding:4px 10px; white-space:nowrap;
}
.chip .sub{ color:#86a6d3; margin-left:6px; }

.log{
  max-height:260px; overflow:auto; padding:8px;
  background:#0e1f38; border:1px solid #122a4f; border-radius:10px;
}
.ok{ color:var(--ok); } .warn{ color:var(--warn); } .bad{ color:var(--bad); }

.mono{ font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace; }

/* ---------- Help Modal + Legend ---------- */
.modal.hidden{ display:none; }
.modal{
  position:fixed; inset:0; display:grid; place-items:center; z-index:50;
}
.modal .backdrop{
  position:absolute; inset:0; background:rgba(0,0,0,.55); backdrop-filter: blur(2px);
}
.modal .dialog{
  position:relative; width:min(920px, calc(100% - 32px));
  background:#0f1f3a; border:1px solid #1a355f; border-radius:16px; box-shadow: var(--shadow);
  padding:18px; z-index:1;
}
.modal .dialog header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
.modal .dialog .close{
  border:none; background:#102544; color:var(--ink); border:1px solid #193256;
  padding:6px 10px; border-radius:999px; cursor:pointer;
}

.legendTable{ width:100%; border-collapse:separate; border-spacing:0 8px; }
.legendTable td{ padding:4px 8px; vertical-align:middle; }
.legendTable tr{ background:#0e1f38; border:1px solid #122a4f; border-radius:10px; }
.legendTable canvas.gridtile{ width:24px; height:24px; border-radius:6px; image-rendering: pixelated; }

/* ---------- Utilities ---------- */
.space-y-8 > * + *{ margin-top:8px; }

/* ---------- Responsive ---------- */
@media (max-width: 1280px){
  .layout.layout-3col{ grid-template-columns: 280px 1fr 380px; }
}
@media (max-width: 1024px){
  .layout.layout-3col{ grid-template-columns: 1fr; }
  .col-right{ order:3; }
  .col-left{ order:1; }
  .col-mid{ order:2; }
  .queue{ min-height:0; }
}
